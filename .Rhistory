<<<<<<< HEAD
html_text() %>%
str_replace_all(".*\\,", "") %>%
str_trim()
}
get_city_essen(html_essen)
html_essen %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "") %>%
html_essen %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "")
html_essen %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "")
html_essen %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "")
html_essen %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "") %>%
str_trim()
library(purrr)
html_essen %>%
html_elements(".is-center-v") %>%
html_text() %>%
html_essen %>%
html_elements(".is-center-v") %>%
html_text()
html_essen %>%
html_elements(".is-center-v") %>%
html_text()
html_essen %>%
map(.x = ., ~ html_elements(".noProject-eaed4")) %>%
html_elements(".is-center-v")
html_essen %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4")) %>%
html_elements(".is-center-v")
html_essen %>%
html_elements(".is-center-v") %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4"))
html_essen %>%
html_nodes(".is-center-v") %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4"))
html_essen %>%
html_nodes(".&nbsp") %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4"))
html_essen %>%
html_nodes(".is-center-v") %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4"))
html_essen %>%
html_nodes(".is-center-v") %>%
map(.x = ., ~ html_elements(".noProject-eaed4"))
html_essen %>%
html_nodes(".is-center-v") %>%
html_text() %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4"))
html_essen %>%
html_nodes(".is-center-v") %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4")) %>%
html_text()
html_essen %>%
html_nodes(".is-center-v") %>%
map(.x = ., ~ html_elements(".noProject-eaed4")) %>%
html_text()
html_essen %>%
html_elements(".is-center-v") %>%
map(.x = ., ~ html_elements(".noProject-eaed4")) %>%
html_text()
html_essen %>%
html_elements(".is-center-v") %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4")) %>%
html_text()
html_essen %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text()
html_essen %>%
html_elements(".is-center-v") %>%
html_text()
html_essen %>%
html_elements(".is-center-v") %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4"))
html_test <- read_html("https://www.immowelt.de/expose/25wua5q")
html_test %>%
html_elements(".is-center-v")
html_test %>%
html_elements("&nbsp")
html_test %>%
html_elements("nbsp")
html_test %>%
html_elements(".cell__row")
html_test %>%
html_elements("#exposeAddress .cell__row")
html_test %>%
html_elements(".#exposeAddress div")
html_test %>%
html_elements("#exposeAddress div")
html_essen %>%
html_elements("#exposeAddress div") %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4"))
map(1:3, ~ . * 3)
html_essen %>%
html_elements("#exposeAddress div")
html_test %>%
html_elements("#exposeAddress div")
html_test %>%
html_elements("#exposeAddress div") %>%
map_chr(.x = ., ~ html_elements(".noProject-eaed4")) %>%
str_replace_all(".*\\,", "") %>%
str_trim()
html_essen %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "") %>%
str_trim()
html_test %>%
html_elements("#exposeAddress div")
html_test %>%
html_elements("#exposeAddress div") %>%
str_replace_all(".*\\>", "")
html_test %>%
html_elements("#exposeAddress div") %>%
str_replace_all(".*\\>", "")
html_test %>%
html_elements("#exposeAddress div") %>%
html_attr()
html_test %>%
html_elements("#exposeAddress div") %>%
html_attr()
html_test %>%
html_elements("#exposeAddress div") %>%
html_attr("#exposeAddress div")
html_test %>%
html_attr("#exposeAddress div")
html_test %>%
html_elements("#exposeAddress div")
html_test %>%
html_elements("#exposeAddress div") %>%
str_replace_all(".*\\,", "")
html_test %>%
html_elements("#exposeAddress div") %>%
map_chr(.x = ., ~ html_elements("#exposeAddress div")) %>%
str_replace_all(".*\\>", "")
html_test %>%
html_elements("#exposeAddress div") %>%
map(.x = ., ~ html_elements("#exposeAddress div")) %>%
str_replace_all(".*\\>", "")
html_test %>%
html_elements("#exposeAddress div") %>%
map(.x = ., ~ html_elements("#exposeAddress div"))
html_test %>%
html_elements("#exposeAddress div") %>%
map_chr(.x = ., ~ html_elements("#exposeAddress div"))
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(1)")
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text()
html_test %>%
html_elements("#exposeAddress div") %>%
html_nodes()
html_test %>%
html_elements("#exposeAddress div") %>%
html_nodes("#exposeAddress div")
html_test %>%
html_elements("#exposeAddress div") %>%
html_text()
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text() %>%
str_trim()
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text()
get_cold_rent_essen <- function(html_essen){
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text() %>%
str_trim()
}
get_cold_rent_essen(html_essen)
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(2)")
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text()
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_trim()
get_square_meters(html_essen)
get_square_meters <- function(html_essen){
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_trim()
}
get_square_meters(html_essen)
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim()
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_trim()
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text() %>%
str_trim()
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim() %>%
as.numeric()
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim()
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_replace_all(".*\\", "")
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_replace_all(".*\\Z", "")
get_square_meters <- function(html_essen){
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_trim()
}
get_square_meters(html_essen)
get_rooms <- function(html_essen){
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim()
}
get_rooms(html_essen)
url_essen_1 <- ("https://www.immowelt.de/liste/essen/wohnungen/mieten?sort=relevanz")
html_essen <- read_html(url_essen_1)
get_url_essen <- function(html_essen){
html_essen %>%
html_elements(".noProject-eaed4") %>%
html_attr("href")
}
get_url_essen(html_essen)
get_title_essen <- function(html_essen){
html_essen %>%
html_elements("h2") %>%
html_text() %>%
str_trim()
}
get_title_essen(html_essen)
# c) Scraping the area of the city
get_city_essen <- function(html_essen){
html_essen %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "") %>%
str_trim()
}
get_city_essen(html_essen)
html_test %>%
html_elements("#exposeAddress div") %>%
html_text()
# e) cold rent
get_cold_rent_essen <- function(html_essen){
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text() %>%
str_trim()
}
get_cold_rent_essen(html_essen)
# f) square meters
get_square_meters <- function(html_essen){
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_trim()
}
get_square_meters(html_essen)
# g) rooms
get_rooms <- function(html_essen){
html_essen %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim()
}
get_rooms(html_essen)
get_rooms_1 <- function(html_essen_1){
html_essen_1 %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim()
}
get_rooms_1(html_essen_1)
url_essen_1 <- ("https://www.immowelt.de/liste/essen/wohnungen/mieten?sort=relevanz")
html_essen_1 <- read_html(url_essen_1)
get_rooms_1 <- function(html_essen_1){
html_essen_1 %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim()
}
get_rooms_1(html_essen_1)
get_square_meters_1 <- function(html_essen_1){
html_essen_1 %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_trim()
}
get_square_meters_1(html_essen_1)
get_cold_rent_essen_1 <- function(html_essen_1){
html_essen_1 %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text() %>%
str_trim()
}
get_cold_rent_essen_1(html_essen_1)
html_test %>%
html_elements("#exposeAddress div") %>%
html_text()
get_city_essen_1 <- function(html_essen_1){
html_essen_1 %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "") %>%
str_trim()
}
get_city_essen_1(html_essen_1)
get_title_essen_1 <- function(html_essen_1){
html_essen_1 %>%
html_elements("h2") %>%
html_text() %>%
str_trim()
}
get_title_essen_1(html_essen_1)
get_url_essen_1 <- function(html_essen_1){
html_essen_1 %>%
html_elements(".noProject-eaed4") %>%
html_attr("href")
}
get_url_essen_1(html_essen_1)
url_essen_2 <- ("https://www.immowelt.de/liste/essen/wohnungen/mieten?d=true&sd=DESC&sf=RELEVANCE&sp=2")
html_essen_2 <- read_html(url_essen_2)
## a) Scraping the URL for the first page (20 objects)
get_url_essen_2 <- function(html_essen_2){
html_essen_2 %>%
html_elements(".noProject-eaed4") %>%
html_attr("href")
}
get_url_essen_2(html_essen_2)
get_title_essen_2 <- function(html_essen_2){
html_essen_2 %>%
html_elements("h2") %>%
html_text() %>%
str_trim()
}
get_title_essen_2(html_essen_)
get_title_essen_2 <- function(html_essen_2){
html_essen_2 %>%
html_elements("h2") %>%
html_text() %>%
str_trim()
}
get_title_essen_2(html_essen_2)
# c) Scraping the area of the city
get_city_essen_2 <- function(html_essen_2){
html_essen_2 %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "") %>%
str_trim()
}
get_city_essen_2(html_essen_2)
# e) cold rent
get_cold_rent_essen_2 <- function(html_essen_2){
html_essen_2 %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text() %>%
str_trim()
}
get_cold_rent_essen_2(html_essen_2)
# f) square meters
get_square_meters_2 <- function(html_essen_2){
html_essen_2 %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_trim()
}
get_square_meters_2(html_essen_2)
# g) rooms
get_rooms_2 <- function(html_essen_2){
html_essen_2 %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim()
}
get_rooms_2(html_essen_2)
url_bochum_1 <- ("https://www.immowelt.de/liste/bochum/wohnungen/mieten?sort=relevanz")
html_bochum_1 <- read_html(url_bochum_1)
get_url_bochum_1 <- function(html_bochum_1){
html_bochum_1 %>%
html_elements(".noProject-eaed4") %>%
html_attr("href")
}
get_url_bochum_1(html_bochum_1)
url_bochum_1 <- ("https://www.immowelt.de/liste/bochum/wohnungen/mieten?sort=relevanz")
html_bochum_1 <- read_html(url_bochum_1)
get_url_bochum_1 <- function(html_bochum_1){
html_bochum_1 %>%
html_elements(".noProject-eaed4") %>%
html_attr("href")
}
get_url_bochum_1(html_bochum_1)
# b) Now Scraping the title of the first 20 advertisements
get_title_bochum_1 <- function(html_bochum_1){
html_bochum_1 %>%
html_elements("h2") %>%
html_text() %>%
str_trim()
}
get_title_bochum_1(html_bochum_1)
# c) Scraping the area of the city
get_city_bochum_1 <- function(html_bochum_1){
html_bochum_1 %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "") %>%
str_trim()
}
get_city_bochum_1(html_bochum_1)
# e) cold rent
get_cold_rent_bochum_1 <- function(html_bochum_1){
html_bochum_1 %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text() %>%
str_trim()
}
get_cold_rent_bochum_1(html_bochum_1)
# f) square meters
get_square_meters_bochum_1 <- function(html_bochum_1){
html_bochum_1 %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_trim()
}
get_square_meters_bochum_1(html_bochum_1)
# g) rooms
get_rooms_bochum_1 <- function(html_bochum_1){
html_bochum_1 %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim()
}
get_rooms_bochum_1(html_bochum_1)
url_bochum_2 <-
("https://www.immowelt.de/liste/bochum/wohnungen/mieten?d=true&sd=DESC&sf=RELEVANCE&sp=2")
html_bochum_2 <- read_html(url_bochum_2)
get_url_bochum_2 <- function(html_bochum_2){
html_bochum_2 %>%
html_elements(".noProject-eaed4") %>%
html_attr("href")
}
get_url_bochum_2(html_bochum_2)
# b) Now Scraping the title of the first 20 advertisements
get_title_bochum_2 <- function(html_bochum_2){
html_bochum_2 %>%
html_elements("h2") %>%
html_text() %>%
str_trim()
}
get_title_bochum_2(html_bochum_2)
get_city_bochum_2 <- function(html_bochum_2){
html_bochum_2 %>%
html_elements(".IconFact-e8a23:nth-child(1) span") %>%
html_text() %>%
str_replace_all(".*\\,", "") %>%
str_trim()
}
get_city_bochum_2(html_bochum_2)
# e) cold rent
get_cold_rent_bochum_2 <- function(html_bochum_2){
html_bochum_2 %>%
html_elements(".KeyFacts-efbce div:nth-child(1)") %>%
html_text() %>%
str_trim()
}
get_cold_rent_bochum_2(html_bochum_2)
# f) square meters
get_square_meters_bochum_2 <- function(html_bochum_2){
html_bochum_2 %>%
html_elements(".KeyFacts-efbce div:nth-child(2)") %>%
html_text() %>%
str_trim()
}
get_square_meters_bochum_2(html_bochum_2)
# g) rooms
get_rooms_bochum_2 <- function(html_bochum_2){
html_bochum_2 %>%
html_elements(".KeyFacts-efbce div:nth-child(3)") %>%
html_text() %>%
str_trim()
}
get_rooms_bochum_2(html_bochum_2)
=======
labs(title = "Comparing absolut warm Rent vs. cold Rent for Bochum and Essen",
x="Cold rent",y="Warm rent" )
immowelt_clean%>%
ggplot(aes(x=cold_rent_qm, y=warm_rent_qm, color=city))+
geom_boxplot()+
labs(title = "Comparing warm Rent vs. cold Rent per square meter for Bochum and Essen",
x ="Cold rent per qm", y = "Warm rent per qm")
#g)
immowelt_clean %>%
select(heating_cost_included, square_meter, warm_rent) %>%
mutate(share_nebenkosten = (heating_cost_included+immowelt_clean$service_charges)
/warm_rent*100) %>%
ggplot(aes(x=square_meter, y=share_nebenkosten))+
geom_point()+
labs(title = " Share of Nebenkosten of the warm rent",
x="Appartment size in square meter", y="Share in %")
View(immowelt)
View(immowelt_clean)
#a) load the immowelt date in R
load(here::here("rent_advertisements.RData"))
immowelt %>%
select( - heating_cost_excluded)
immowelt %>%
select( - heating_cost_excluded)
load(here::here("rent_advertisements.RData"))
head(immowelt)
## omit column "heating_cost_excluded" as it contains no data (NAs)
immowelt %><%
select(- heating_cost_excluded)
## omit column "heating_cost_excluded" as it contains no data (NAs)
immowelt %>%
select(- heating_cost_excluded)
head(immowelt)
names(immowelt)
#overview of the data
immowelt %>%
knitr::kable(booktabs = TRUE, linesep = "",
escape = TRUE, caption = 'Immowelt'
) |>
kableExtra::kable_styling(font_size = 10,
latex_options = c("striped", "hold_position")) %>%
kableExtra::row_spec(0, bold = TRUE)
#### clean all non-available data (NA)
immowelt_clean <- na.omit(immowelt)
immowelt_clean
# Ensure that all variables of the dataset are stored using a proper class
char_v <- c("title","building_year")
immowelt_clean %<>%
mutate(across(where(is.character) &! any_of(char_v),
as.factor))
immowelt_clean %<>%
mutate(building_year = as.numeric(building_year))
immowelt_clean %<>%
mutate(cold_rent_qm = cold_rent / square_meter) %>%
mutate(warm_rent_qm = warm_rent / square_meter)
immowelt_clean$cold_rent_qm
immowelt_clean$warm_rent_qm
ads_essen <- immowelt_clean %>%
filter(city =="essen") %>%
group_by(zipcode) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>%
slice(1:5)
ads_bochum <- immowelt_clean%>%
filter(city=="bochum")%>%
group_by(zipcode)%>%
summarise(count=n())%>%
arrange(desc(count))%>%
slice(1:5)
full_join(ads_bochum,ads_essen)  # one table for each city
#d)
immowelt_clean %>%
mutate(zipcode = factor(zipcode, c("45141","45147","45279","45326","45355",
"44793","44795","44866","44809","44801"))) %>%
drop_na() %>%
ggplot(aes(x=zipcode, y=warm_rent, color=city)) +
geom_boxplot() +
labs(title = 'Boxplot for the ten district with the most ads for essen and bochum',
x ="\n Zipcode", y ="\n warm rent")+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
immowelt_clean %>%
ggplot(aes(x = square_meter, y = cold_rent_qm, color = city)) +
geom_point() +
geom_smooth(se=FALSE) +
labs(title = "Relatonship between square meter and warm rent per square meter",
x ="square meter", y ="cold rent per qm")
immowelt_clean %>%
ggplot(aes(x = square_meter, y = warm_rent_qm, color = city)) +
geom_point() +
geom_smooth(se=FALSE) +
labs(title = "Relatonship between square meter and warm rent per square meter",
x="square meter", y="warm rent per qm")
#f)
immowelt_clean%>%
ggplot(aes(x=cold_rent,y=warm_rent, color=city))+
geom_boxplot()+
labs(title = "Comparing absolut warm Rent vs. cold Rent for Bochum and Essen",
x="Cold rent",y="Warm rent" )
immowelt_clean%>%
ggplot(aes(x=cold_rent_qm, y=warm_rent_qm, color=city))+
geom_boxplot()+
labs(title = "Comparing warm Rent vs. cold Rent per square meter for Bochum and Essen",
x ="Cold rent per qm", y = "Warm rent per qm")
immowelt_clean %>%
select(heating_cost_included, square_meter, warm_rent) %>%
mutate(share_nebenkosten = (heating_cost_included+immowelt_clean$service_charges)
/warm_rent*100) %>%
ggplot(aes(x=square_meter, y=share_nebenkosten))+
geom_point()+
labs(title = " Share of Nebenkosten of the warm rent",
x="Appartment size in square meter", y="Share in %")
#h)
#(i)
immowelt_clean %>%
select(efficiency_class,energy_demand, city)%>%
mutate(efficiency_class = factor(efficiency_class,c(
"A","A+","B","C","D","E",
"F","G","H"))) %>%
drop_na() %>%
ggplot(aes(efficiency_class, energy_demand, color = city))+
geom_point()
#(ii)
immowelt_clean %>%
select(efficiency_class, city)%>%
drop_na()%>%
mutate(efficiency_class=factor(efficiency_class,c(
"A","A+","B","C","D","E",
"F","G","H"))) %>%
ggplot(aes(x=efficiency_class))+
geom_bar(stat = 'count', width = 0.5, fill = '#004c93')+
labs(title = "Amount of adds among the efficiency classes",
x=" energy class", "amount", y = "ad count")
## Number 2)
library(dplyr)
library(knitr)
library(stringr)
library(here)
library(stringi)
library(janitor)
library(magrittr)
library(lubridate)
library(tibble)
library(kableExtra)
library(ggplot2)
library(zoo)
library(stargazer)
library(modelr)
library(tidyr)
library(tidyverse)
library(rvest)
#a) load the immowelt date in R
load(here::here("rent_advertisements.RData"))
## omit column "heating_cost_excluded" as it contains no data (NAs)
immowelt %>%
select( - heating_cost_excluded)
head(immowelt)
## omit column "heating_cost_excluded" as it contains no data (NAs)
immowelt %>%
select(-heating_cost_excluded)
#overview of the data
immowelt %>%
knitr::kable(booktabs = TRUE, linesep = "",
escape = TRUE, caption = 'Immowelt'
) |>
kableExtra::kable_styling(font_size = 10,
latex_options = c("striped", "hold_position")) %>%
kableExtra::row_spec(0, bold = TRUE)
#### clean all non-available data (NA)
immowelt_clean <- na.omit(immowelt)
immowelt_clean
View(immowelt_clean)
#### clean all non-available data (NA)
immowelt_clean <- na.omit(immowelt)
immowelt_clean
### heating_cost_excluded Spalte rausschmeißen, dort sind nur NAs
immowelt%<>%
select(-heating_cost_excluded)
head(immowelt)
load(here::here("rent_advertisements.RData"))
### heating_cost_excluded Spalte rausschmeißen, dort sind nur NAs
immowelt%<>%
select(-heating_cost_excluded)
head(immowelt)
names(immowelt)
immowelt %>%
knitr::kable(booktabs = TRUE, linesep = "",
escape = TRUE, caption = 'Immowelt'
) |>
kableExtra::kable_styling(font_size = 10,
latex_options = c("striped", "hold_position")) %>%
kableExtra::row_spec(0, bold = TRUE)
#### clean all non-available data (NA)
immowelt_clean <- na.omit(immowelt)
immowelt_clean
# Ensure that all variables of the dataset are stored using a proper class
char_v <- c("title","building_year")
immowelt_clean %<>%
mutate(across(where(is.character) &! any_of(char_v),
as.factor))
immowelt_clean %<>%
mutate(building_year = as.numeric(building_year))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(stringr)
library(here)
library(stringi)
library(janitor)
library(magrittr)
library(lubridate)
library(tibble)
library(kableExtra)
library(ggplot2)
library(zoo)
library(stargazer)
library(modelr)
library(tidyr)
library(tidyverse)
library(rvest)
load(here::here("rent_advertisements.RData"))
immowelt %><%
select(-heating_cost_excluded)
immowelt %>%
select(-heating_cost_excluded)
head(immowelt)
names(immowelt)
library(rmarkdown)
library(dplyr)
library(knitr)
library(stringr)
library(here)
library(stringi)
library(janitor)
library(magrittr)
library(lubridate)
library(tibble)
library(kableExtra)
library(ggplot2)
library(zoo)
library(stargazer)
library(modelr)
library(tidyr)
library(tidyverse)
library(rvest)
#a) load the immowelt date in R
load(here::here("rent_advertisements.RData"))
## omit column "heating_cost_excluded" as it contains no data (NAs)
immowelt %<>%
select(-heating_cost_excluded)
head(immowelt)
names(immowelt)
#overview of the data
immowelt %>%
knitr::kable(booktabs = TRUE, linesep = "",
escape = TRUE, caption = 'Immowelt'
) |>
kableExtra::kable_styling(font_size = 10,
latex_options = c("striped", "hold_position")) %>%
kableExtra::row_spec(0, bold = TRUE)
#### clean all non-available data (NA)
immowelt_clean <- na.omit(immowelt)
immowelt_clean
immowelt %<>%
select(-heating_cost_excluded)
library(dplyr)
library(knitr)
library(stringr)
library(here)
library(stringi)
library(janitor)
library(magrittr)
library(lubridate)
library(tibble)
library(kableExtra)
library(ggplot2)
library(zoo)
library(stargazer)
library(modelr)
library(tidyr)
library(tidyverse)
library(rvest)
load(here::here("rent_advertisements.RData"))
immowelt %<>%
select(-heating_cost_excluded)
head(immowelt)
names(immowelt)
char_v <- c("title","building_year")
immowelt_clean %<>%
mutate(across(where(is.character) &! any_of(char_v),
as.factor))
immowelt %>%
knitr::kable(booktabs = TRUE, linesep = "",
escape = TRUE, caption = 'Immowelt'
) |>
kableExtra::kable_styling(font_size = 10,
latex_options = c("striped", "hold_position")) %>%
kableExtra::row_spec(0, bold = TRUE)
char_v <- c("title","building_year")
immowelt_clean %<>%
mutate(across(where(is.character) &! any_of(char_v),
as.factor))
library(dplyr)
library(knitr)
library(stringr)
library(here)
library(stringi)
library(janitor)
library(magrittr)
library(lubridate)
library(tibble)
library(kableExtra)
library(ggplot2)
library(zoo)
library(stargazer)
library(modelr)
library(tidyr)
library(tidyverse)
library(rvest)
load(here::here("rent_advertisements.RData"))
immowelt %<>%
select(-heating_cost_excluded)
head(immowelt)
names(immowelt)
immowelt %>%
knitr::kable(booktabs = TRUE, linesep = "",
escape = TRUE, caption = 'Immowelt'
) |>
kableExtra::kable_styling(font_size = 10,
latex_options = c("striped", "hold_position")) %>%
kableExtra::row_spec(0, bold = TRUE)
immowelt_clean <- na.omit(immowelt)
immowelt_clean
char_v <- c("title","building_year")
immowelt_clean %<>%
mutate(across(where(is.character) &! any_of(char_v),
as.factor))
immowelt_clean %<>%
mutate(building_year = as.numeric(building_year))
immowelt_clean %<>%
mutate(cold_rent_qm = cold_rent / square_meter) %>%
mutate(warm_rent_qm = warm_rent / square_meter)
immowelt_clean$cold_rent_qm
immowelt_clean$warm_rent_qm
ads_essen <- immowelt_clean %>%
filter(city =="essen") %>%
group_by(zipcode) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>%
slice(1:5)
ads_bochum <- immowelt_clean%>%
filter(city=="bochum")%>%
group_by(zipcode)%>%
summarise(count=n())%>%
arrange(desc(count))%>%
slice(1:5)
full_join(ads_bochum,ads_essen)
``{r}
immowelt_clean %>%
mutate(zipcode = factor(zipcode, c("45141","45147","45279","45326","45355",
"44793","44795","44866","44809","44801"))) %>%
drop_na() %>%
ggplot(aes(x=zipcode, y=warm_rent, color=city)) +
geom_boxplot() +
labs(title = 'Boxplot for the ten district with the most ads for essen and bochum',
x ="\n Zipcode", y ="\n warm rent")+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
immowelt_clean %>%
ggplot(aes(x = square_meter, y = cold_rent_qm, color = city)) +
geom_point() +
geom_smooth(se=FALSE) +
labs(title = "Relatonship between square meter and warm rent per square meter",
x ="square meter", y ="cold rent per qm")
immowelt_clean %>%
ggplot(aes(x = square_meter, y = warm_rent_qm, color = city)) +
geom_point() +
geom_smooth(se=FALSE) +
labs(title = "Relatonship between square meter and warm rent per square meter",
x="square meter", y="warm rent per qm")
dbWriteTable(connection,
name="metro_2",
value=metro_R)
library(rmarkdown)
library(dplyr)
library(knitr)
library(stringr)
library(here)
library(stringi)
library(janitor)
library(magrittr)
library(lubridate)
library(tibble)
library(kableExtra)
library(ggplot2)
library(zoo)
library(stargazer)
library(modelr)
library(tidyr)
library(tidyverse)
library(rvest)
metro_R %>%
mutate(weekday=factor(weekday, c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag",
"Samstag","Sonntag"))) %>%
ggplot(aes(x=weekday, y=traffic_volume))+
geom_boxplot(color="steelblue")+
labs(title = "Boxplot of traffic volume and Weekday",
x="Weekday", y="traffic Volume")
#i) add out modify dataframe to the database as metro_2
dbWriteTable(connection,
name="metro_2",
value=metro_R)
library(dplyr)
library(knitr)
library(stringr)
library(here)
library(stringi)
library(janitor)
library(magrittr)
library(lubridate)
library(tibble)
library(kableExtra)
library(ggplot2)
library(zoo)
library(stargazer)
library(modelr)
library(tidyr)
library(tidyverse)
library(rvest)
library(DBI)
library(RSQLite)
metro_R %>%
mutate(weekday=factor(weekday, c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag",
"Samstag","Sonntag"))) %>%
ggplot(aes(x=weekday, y=traffic_volume))+
geom_boxplot(color="steelblue")+
labs(title = "Boxplot of traffic volume and Weekday",
x="Weekday", y="traffic Volume")
#i) add out modify dataframe to the database as metro_2
dbWriteTable(connection,
name="metro_2",
value=metro_R)
# a) function that uses a standard ggplot2 theme
theme_favourite <- function(){
theme_classic() %+replace%
theme(
text = element_text(family = "serif", size = 16),
panel.spacing = unit(2, "cm"),
panel.grid.major = element_line(colour = "blue"),
panel.grid.minor = element_line(color = "blue")
)
}
# b)
ggscatt <- function(data,x,y){
ggplot(data, aes(x = x, y=y)) +
geom_point() +
theme_favourite()+
labs(title = "A scatter plot") +
facet_grid()
}
ggscatt(data = mtcars, mtcars$mpg , mtcars$hp)
## c) relative connection to the database
connection <- DBI::dbConnect(
drv = RSQLite::SQLite(),
dbname = here::here("assignment_1.sqlite3"),
)
# show the list of table in database
DBI::dbListTables(connection)
# d)  create an object which is a reference to a table in the database
metro<-tbl(connection, "metro")
head(metro)
# actually pulls the data into R.
metro_R<-metro %>%
collect(n=Inf)
head(metro_R)
# e) Ensure, that all variables are stored using a proper class,
# convert date_time as a time vector
metro_R%<>%
mutate(date_time=as_datetime(date_time))
tail(metro_R) #works good.
# f) create a new variable weekday that represents the weekdays
metro_R %<>%
mutate(weekday=weekdays(date_time))
#g
ggscatt(data = metro_R, metro_R$traffic_volume, metro_R$temp)
ggscatt(data = metro_R, metro_R$traffic_volume, metro_R$rain_1h)
ggscatt(data = metro_R, metro_R$traffic_volume, metro_R$snow_1h)
ggscatt(data = metro_R, metro_R$traffic_volume, metro_R$clouds_all)
# h) create a boxplot with weekday on x-asix, traffic_volume on y-axis
metro_R %>%
mutate(weekday=factor(weekday, c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag",
"Samstag","Sonntag"))) %>%
ggplot(aes(x=weekday, y=traffic_volume))+
geom_boxplot(color="steelblue")+
labs(title = "Boxplot of traffic volume and Weekday",
x="Weekday", y="traffic Volume")
#i) add out modify dataframe to the database as metro_2
dbWriteTable(connection,
name="metro_2",
value=metro_R)
dbListTables(connection)
metro_R %>%
mutate(weekday=factor(weekday, c("Montag","Dienstag","Mittwoch","Donnerstag","Freitag",
"Samstag","Sonntag"))) %>%
ggplot(aes(x=weekday, y=traffic_volume))+
geom_boxplot(color="steelblue")+
labs(title = "Boxplot of traffic volume and Weekday",
x="Weekday", y="traffic Volume")
dbWriteTable(connection,
name="metro_2",
value=metro_R)
db_list_tables(connection)
>>>>>>> 892e538bcc67a8a6d7585c50cf09a0837d94ccf9
